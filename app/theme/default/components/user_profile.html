{{define "components/user_profile.html"}}
<!-- Debug info -->
<!-- Session logged_in: {{.session.logged_in}} -->
<!-- Current User: {{.currentUser}} -->
<div class="relative" x-data="{ open: false }">
  {{if .currentUser}}
    <!-- User is logged in -->
    <div>
      <button @click="open = !open" type="button" class="flex items-center gap-x-1 text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2" id="user-menu-button" aria-expanded="false" aria-haspopup="true">
        <span class="sr-only">{{tr "common.open_user_menu"}}</span>
        <div class="h-8 w-8 rounded-full bg-indigo-100 flex items-center justify-center">
          <span class="text-indigo-700 font-medium text-sm">{{index .currentUser.Name 0 | upper}}</span>
        </div>
        <span class="hidden md:block text-gray-700">{{.currentUser.Name}}</span>
      </button>
      
      <!-- Dropdown menu -->
      <div 
        x-show="open" 
        @click.away="open = false"
        x-transition:enter="transition ease-out duration-100"
        x-transition:enter-start="transform opacity-0 scale-95"
        x-transition:enter-end="transform opacity-100 scale-100"
        x-transition:leave="transition ease-in duration-75"
        x-transition:leave-start="transform opacity-100 scale-100"
        x-transition:leave-end="transform opacity-0 scale-95"
        class="origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none" 
        role="menu" 
        aria-orientation="vertical" 
        aria-labelledby="user-menu-button" 
        tabindex="-1"
        style="display: none;">
        <div class="px-4 py-3 border-b" role="none">
          <p class="text-sm font-medium text-gray-900 truncate">{{.currentUser.Name}}</p>
        </div>
        <div class="py-1" role="none">
          <a href="/users/me" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" role="menuitem" tabindex="-1" id="user-menu-item-0">{{tr "navigation.profile"}}</a>
          <form method="POST" action="/auth/logout" role="none">
            <button type="submit" class="block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" role="menuitem" tabindex="-1" id="user-menu-item-2">{{tr "navigation.logout"}}</button>
          </form>
        </div>
      </div>
    </div>
  {{else}}
    <!-- User is not logged in -->
    <div class="flex space-x-4">
      <a href="/auth/login" class="text-gray-700 hover:text-gray-900 px-3 py-2 text-sm font-medium">
        {{tr "auth.login"}}
      </a>
      <a href="/auth/register" class="bg-indigo-600 text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-indigo-700">
        {{tr "auth.register"}}
      </a>
    </div>
  {{end}}
</div>
{{end}}